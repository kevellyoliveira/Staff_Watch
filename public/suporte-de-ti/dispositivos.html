<!DOCTYPE html>
<html lang="ptbr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href=".././css/dashboardDispositivos.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- script do modal -->
    <script src=".././js/script.js" defer></script>

    <!-- script do chartJs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="shortcut icon" href=".././src/img/logoB.png" type="image/x-icon" />

    <title>Dispositivos | Staff Watch</title>
</head>

<body onload="atualizarFeed()">
    <header>
        <div class="opcoes">
            <div class="esq">
                <div class="logo">
                    <img href="index.html" src=".././src/img/logoB.png" alt="logo">
                </div>

                <div class="menuCima" id="itens">
                    <h6 class="opcoesMenu slct" onclick="window.location.href='dispositivos.html'">Dispositivos</h6>
                </div>
            </div>

            <div class="sair">
                <h6 class="opcoesMenu sair" onclick="sair()"> Sair </h6>
            </div>
        </div>
    </header>
    <div class="corpo">
        <div class="menuLateral">
            <div class="itens">
                <h4 id="1" onclick="window.location.href='../dashboard-matheus.html'"> CPU </h4>
                <h4 id="2" onclick="window.location.href='../dashboard-matheus.html'">Disco</h4>
                <h4 id="3" onclick="window.location.href='../dashboard-matheus.html'">Rede</h4>
                <h4 id="4" onclick="window.location.href='../dashboard-matheus.html'">RAM</h4>
            </div>
        </div>

        <!-- reutilizando da página de máquinas -->

        <main class="main-section">
            <section class="section-grafico">
                <h4> Quantidade de alertas por componente em cada equipe </h4>
                <div class="grafico">
                    <!-- <img src=".././src/img/grafico.png" alt=""> -->
                    <canvas id="graficoEquipe" width="600"></canvas>
                </div>
            </section>

            <section class="sectioncard" id="sectioncard">

                <!-- <div class="card open-modal" onclick="alterarComponente('dashCpu')">

                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorAlerta.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                            <div class="alertaMaquina">
                                <figure> <img src=".././src/img/icons/alerta1.png"> </figure>
                                <p> CPU acima da média (2 horas)</p>
                            </div>
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> 1234</p>
                            <p><b>Funcionário:</b> Julia Oliveira</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" alt="">
                            <img src=".././src/img/icons/excluir.svg" alt="">
                        </div>
                    </div>
                </div>

                <div class="card open-modal" onclick="alterarComponente('dashCpu')">

                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorEstavel.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                        </div>
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> 1234</p>
                            <p><b>Funcionário:</b> Flávio souza</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" alt="">
                            <img src=".././src/img/icons/excluir.svg" alt="">
                        </div>
                    </div>
                </div>

                <div class="card open-modal" onclick="alterarComponente('dashCpu')">

                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorCritico.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                            <div class="alertaMaquina">
                                <figure> <img src=".././src/img/icons/alerta2.png"> </figure>
                                <p> CPU acima da média (8 horas)</p>
                            </div>
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> 1234</p>
                            <p><b>Funcionário:</b> Edu Macedo</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" alt="">
                            <img src=".././src/img/icons/excluir.svg" alt="">
                        </div>
                    </div>
                </div>

                <div class="card open-modal" onclick="alterarComponente('dashCpu')">

                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorEstavel.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                            
                        </div> 
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> 1234</p>
                            <p><b>Funcionário:</b> Raul Gustavo</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" alt="">
                            <img src=".././src/img/icons/excluir.svg" alt="">
                        </div>
                    </div>
                </div>

                <div class="card open-modal" onclick="alterarComponente('dashCpu')">

                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorEstavel.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                            
                        </div> 
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> 1234</p>
                            <p><b>Funcionário:</b> Pedro Lima</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" alt="">
                            <img src=".././src/img/icons/excluir.svg" alt="">
                        </div>
                    </div>
                </div>

                <div class="card open-modal" onclick="alterarComponente('dashCpu')">

                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorAlerta.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                            <div class="alertaMaquina">
                                <figure> <img src=".././src/img/icons/alerta1.png"> </figure>
                                <p> CPU acima da média (2 horas)</p>
                            </div>
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> 1234</p>
                            <p><b>Funcionário:</b> Nicolas Sá</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" alt="">
                            <img src=".././src/img/icons/excluir.svg" alt="">
                        </div>
                    </div>
                </div> -->
            </section>
        </main>

        <!--  MODAL  -->
        <div id="fade" class="hide"></div>
        <div id="modal" class="hide">
            <div class="btnSair">
                <img src=".././src/img/icons/fechar.svg" alt="ícone para sair do modal">
            </div>
            <div class="modal-content">
                <div class="containerModal">
                    <div class="opcoesComponentes menu" id="itens">
                        <h6 class="opcoesMenu" id="cpu" onclick="alterarComponente('dashCpu')"> CPU </h6>
                        <h6 class="opcoesMenu" id="disco" onclick="alterarComponente('dashDisco')"> Disco </h6>
                        <h6 class="opcoesMenu" id="rede" onclick="alterarComponente('dashRede')"> Rede </h6>
                        <h6 class="opcoesMenu" id="memoria" onclick="alterarComponente('dashMemoria')"> Memória
                        </h6>
                    </div>

                    <div class="aside">
                        <div class="dadosComponente">
                            <div class="infosComponente">
                                <!-- <h6 class="componente" id="idComponente"> CPU </h6> -->
                                <h6 class="nomeComponente" id="idNomeComponente"> nome do componente </h6>
                            </div>

                            <h5 class="monitoramento" id="idMonitoramentoGrafico"> Utilização: </h5>
                        </div>

                        <div class="graficoComponente">
                            <div class="graficoChart">
                                <canvas id="myChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div id="dashCpu" class="bside">
                        <div class="dado">
                            <h3> Utilização: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuUtilizacao"> 100% </span> </h2>
                            </div>
                        </div>
                        <div class="dado">
                            <h3> Velocidade: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuVelocidade"> 2,09 GHz </span> </h2>
                            </div>
                        </div>
                        <div class="dado">
                            <h3> Threads: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuThreads"> 2400 </span> </h2>
                            </div>
                        </div>
                        <div class="dado">
                            <h3> Processos: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuProcessos"> 140 </span> </h2>
                            </div>
                        </div>
                        <div class="dado">
                            <h3> Identificadores: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuIdentificadores"> 82750 </span> </h2>
                            </div>
                        </div>
                        <div class="dado">
                            <h3> Tempo de atividade:</h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuTempoDeAtividade"> 0:08:17:42 </span> </h2>
                            </div>
                        </div>

                    </div>

                    <div id="dashDisco" class="bside">
                        <div class="dado">
                            <h3> Utilização: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="discoUtilizacao"> 100% </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Tempo de resposta: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="discoResposta"> 0,1 ms </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Velocidade de leitura: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="discoLeitura"> 90,8 KB/s </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Velocidade de gravação: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="discoGravacao"> 130,2 KB/s </span> </h2>
                            </div>
                        </div>
                    </div>

                    <div id="dashRede" class="bside">
                        <div class="dado">
                            <h3> Dados <br>Enviados: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="redeEnviar"> 120,2 MB/s </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Dados Recebidos: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="redeReceber"> 390,1 MB/s </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Dados Perdidos: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="redePerdido"> 10,1 MB/s </span> </h2>
                            </div>
                        </div>

                    </div>


                    <div id="dashMemoria" class="bside">

                        <div class="dado">
                            <h3> Utilização: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaUtilizacao"> 44% </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Disponível: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaDisponivel"> 8,9 GB </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Confirmado: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaConfirmado"> 10,1/22,7 GB </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Cache: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaCache"> 4,6 GB </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Reserva paginável: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaPaginavel"> 580 MB </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Reserva não paginável: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaNaoPaginavel"> 460 MB </span> </h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
<script>
// ============= FUNÇÃO DE ATUALIZAR O FEED - LISTAR MÁQUINAS

function atualizarFeed() {
        var fkEmpresa = sessionStorage.getItem("ID_EMPRESA")
        console.log(fkEmpresa)
        fetch(`/maquinas/listar/${fkEmpresa}`).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("sectioncard");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado.";
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    var feed = document.getElementById("sectioncard");
                    feed.innerHTML = ""; // Limpa o conteúdo atual do feed
                    for (let i = 0; i < resposta.length; i++) {
                        var publicacao = resposta[i];

                        // atualizando para os valores do usuario
                        var idComputador = resposta[i].idComputador
                        var status = Number(resposta[i].status);
                        var fkEquipe = resposta[i].fkEquipe;
                        var fkFuncionario = resposta[i].fkFuncionario;
                        var nomeFuncionario = resposta[i].nomeFuncionario;

                        // definindo o status em texto de acordo com a fk
                        if (status == 1) {
                            status = "Em atividade"
                        }
                        else if (status == 2) {
                            status = "Inativo"
                        }

                        feed.innerHTML += `<div class="card open-modal" onclick="alterarComponente('dashCpu')">
                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorAlerta.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                            <div class="alertaMaquina">
                                <figure> <img src=".././src/img/icons/alerta1.png"> </figure>
                                <p> CPU acima da média (2 horas)</p>
                            </div>
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> ${idComputador}</p>       
                            <p><b>Equipe:</b> ${fkEquipe}</p>
                            <p><b>Funcionário:</b> ${nomeFuncionario}</p>
                            <p><b>Status:</b> ${status}</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" onclick="atualizarMaquina(${idComputador})">
                            <img src=".././src/img/icons/excluir.svg" onclick="deletar(${idComputador})">
                        </div>
                    </div>
                </div>`;

                        // // Definindo conteúdo dos elementos
                        // spanID.innerHTML = "<div class='id'> Id Máquina: <b>" + publicacao.idComputador + "</b> </div> <br>";
                        // spanTitulo.innerHTML = "Equipe: <b>" + publicacao.nomeEquipe + "</b>";
                        // spanNome.innerHTML = "Funcionario: <b>" + publicacao.nomeFuncionario + "</b>";
                        // // divDescricao.innerHTML = "Status: <b>" + status + "</b>";

                        // if (publicacao.status == 1) {
                        //     divDescricao.innerHTML = "Status: <b style='color: #F6FF53  ;'>" + status + "</b>";

                        // }

                        // if (publicacao.status == 2) {
                        //     divDescricao.innerHTML = "Status: <b style='color: #FFA700;'>" + status + "</b>";

                        // }

                        // // Configurando o botão "Editar"
                        // btnEditar.innerHTML = '<i class="fa-solid fa-pen"></i>'; // Ícone do botão
                        // btnEditar.className = "editar"; // Classe do botão
                        // btnEditar.id = "AbrirModal2_" + publicacao.idComputador; // ID único baseado no ID do funcionário
                        // let idDaVez = publicacao.idComputador
                        // btnEditar.addEventListener('click', function () {
                        //     atualizarMaquina(idDaVez); // Função que redireciona para a página de edição
                        // });

                        // // Configurando o botão "Deletar"
                        // btnDeletar.innerHTML = '<i class="fa-solid fa-trash"></i>'; // Ícone do botão
                        // btnDeletar.className = "deletar"; // Classe do botão
                        // btnDeletar.id = "btnDeletar_" + publicacao.idComputador; // ID único
                        // btnDeletar.addEventListener('click', function () {
                        //     deletar(idDaVez); // Função 'deletar' com ID do funcionário
                        // });

                        // // Adicionando os botões ao container de botões
                        // divButtons.className = "div-buttons";
                        // divButtons.appendChild(btnEditar);
                        // divButtons.appendChild(btnDeletar);

                        // // Adicionando todos os elementos criados ao divPublicacao
                        // divPublicacao.className = "publicacao";
                        // divPublicacao.appendChild(spanID);
                        // divPublicacao.appendChild(spanNome);
                        // divPublicacao.appendChild(spanTitulo);
                        // divPublicacao.appendChild(divDescricao);
                        // divPublicacao.appendChild(divButtons);

                        // // Adicionando o card de publicacao ao feed
                        // feed.appendChild(divPublicacao);
                    }

                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

// ============================================================================================================



// ============ SIMULAÇÃO DO GRÁFICO DA PARTE SUPERIOR DA TELA ==============================================
    
        // Gerar valores aleatórios entre 2 e 19
        document.addEventListener('DOMContentLoaded', function () {
        function getRandomValues() {
            return [Math.floor(Math.random() * 18) + 2, Math.floor(Math.random() * 18) + 2, Math.floor(Math.random() * 18) + 2, Math.floor(Math.random() * 18) + 2];
        }

        const data = {
            labels: ['Equipe 1', 'Equipe 2', 'Equipe 3', 'Equipe 4'],
            datasets: [
                {
                    label: 'CPU',
                    data: getRandomValues(),
                    backgroundColor: 'rgba(255, 99, 132, 0.6)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1
                },
                {
                    label: 'Rede',
                    data: getRandomValues(),
                    backgroundColor: 'rgba(54, 162, 235, 0.6)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                },
                {
                    label: 'RAM',
                    data: getRandomValues(),
                    backgroundColor: 'rgba(75, 192, 192, 0.6)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                },
                {
                    label: 'Disco',
                    data: getRandomValues(),
                    backgroundColor: 'rgba(153, 102, 255, 0.6)',
                    borderColor: 'rgba(153, 102, 255, 1)',
                    borderWidth: 1
                }
            ]
        };

        const config = {
            type: 'bar',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top', // Posição da legenda à esquerda
                        align: 'center',  // Centraliza a legenda verticalmente
                    }
                },
                scales: {
                    x: {
                        stacked: false
                    },
                    y: {
                        beginAtZero: true,
                        max: 20
                    }
                }
            }
        };

        new Chart(
            document.getElementById('graficoEquipe'),
            config
        );
    });

    // funcoes do card da equipe: editar e remover máquina

    function atualizarMaquina(idComputador) {
            // Redireciona o usuário para a página de edição com o ID do funcionário como parâmetro na URL
            if (confirm("Tem a certeza de que deseja reativar esta máquina?")) {
                fetch(`/maquinas/atualizarMaquina/${idComputador}`, {
                    method: "PUT"
                })
                    .then(resposta => {
                        if (resposta.ok) {
                            alert("Máquina reativada com sucesso!");
                            atualizarFeed(); // Atualiza a lista após a exclusão
                        } else {
                            throw "Não foi possível reaativar a maquina";
                        }
                    })
                    .catch(error => {
                        console.error(error);
                        alert("Ocorreu um erro ao tentar reativar a maquina");
                    });
            }
            atualizarFeed()
        }

        function deletar(idComputador) {
            if (confirm("Tem a certeza de que deseja desativar esta máquina?")) {
                fetch(`/maquinas/deletar/${idComputador}`, {
                    method: "PUT"
                })
                    .then(resposta => {
                        if (resposta.ok) {
                            alert("Máquina desativada com sucesso!");
                            atualizarFeed(); // Atualiza a lista após a exclusão
                        } else {
                            throw "Não foi possível desativar a maquina";
                        }
                    })
                    .catch(error => {
                        console.error(error);
                        alert("Ocorreu um erro ao tentar deletar a maquina");
                    });
            }
            atualizarFeed()
        }




    function sair() {
        sessionStorage.clear()
        window.location = "../index.html"
    }

    // função para alterar a equipe selecionada no menu lateral
    // window.onload = function () {
    //     var equipeSelecionada = sessionStorage.getItem('equipeSelecionada');  // Recupera o ID da equipe

    //     if (equipeSelecionada) {
    //         var item = document.getElementById(equipeSelecionada);  // Seleciona o item da equipe

    //         if (item) {
    //             // Remove a classe 'slc' de todos os itens e aplica ao selecionado
    //             var itens = document.querySelectorAll('.menuLateral .itens h4');
    //             itens.forEach(function (el) {
    //                 el.classList.remove('slc');
    //             });

    //             // Adiciona a classe 'slc' ao item selecionado
    //             item.classList.add('slc');
    //         }
    //     }
    // };

    // função para carregar a dashboard da equipe com o ID especificado
    function carregarDashboard(id) {
        console.log("Carregando dashboard da equipe com ID:", id);
        // Exemplo: alterarComponente(id);
    }

    function selecionarItem(elemento) {
        // Salvar o id do item selecionado no localStorage
        localStorage.setItem('equipeSelecionada', elemento.id);

        // Remover a classe 'slc' de todos os h4
        var itens = document.querySelectorAll('.menuLateral .itens h4');
        itens.forEach(function (item) {
            item.classList.remove('slc');
        });

        // Adicionar a classe 'slc' ao item clicado
        elemento.classList.add('slc');

    }
    // lembrar de chamar essa funcao pra exibir os graficos dinamicos
    //         alterarComponente("dashCpu");
    //          Chama a função que recarrega a dashboard para a equipe selecionada
    // carregarDashboard(elemento.id);

    // ==========  FUNÇÕES DO MODAL  ================================================================================================================================================
    // função pra fechar o modal quando clicar4 no botão de X
    document.getElementById('fade').addEventListener('click', function () {
        document.getElementById('fade').classList.add('hide');
        document.getElementById('modal').classList.add('hide');
    });

    document.querySelector('.btnSair').addEventListener('click', function () {
        document.getElementById('fade').classList.add('hide');
        document.getElementById('modal').classList.add('hide');
    });

    //GRÁFICO EM TEMPO REAL - SIMULAÇÃO==================================================================================

    const ctx = document.getElementById('myChart').getContext('2d');

    // Cria uma instância do gráfico
    const myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['14:16:34', '14:16:35', '14:16:36', '14:16:37', '14:16:38', '14:16:39'],
            datasets: [{
                label: '% de uso',
                data: [18, 11, 30, 45, 77, 20],
                borderWidth: 1,
                borderColor: "#C7D",
                backgroundColor: "#C7D"
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // Função para gerar um novo valor aleatório para simular os dados do gráfico
    let dadoPublic = 0
    function getRandomValue() {
        let dado = (Math.floor(Math.random() * 100)); // Gera um valor aleatório entre 0 e 100
        dadoPublic = dado
        return dado
    }

    // Função para obter o horário atual como label
    function getCurrentTimeLabel() {
        const now = new Date();
        return now.toLocaleTimeString(); // Retorna o horário no formato HH:MM:SS
    }

    // Função para atualizar o gráfico a cada 1 segundo
    setInterval(function () {
        // Remove o primeiro valor e label se houver mais de 6 pontos (para manter a janela de dados constante)
        if (myChart.data.labels.length > 8) {
            myChart.data.labels.shift(); // Remove o primeiro label
            myChart.data.datasets[0].data.shift(); // Remove o primeiro dado
        }
        // adiciona um novo valor
        myChart.data.labels.push(getCurrentTimeLabel());
        myChart.data.datasets[0].data.push(getRandomValue());

        // Atualiza o gráfico
        myChart.update();

        // enviando alerta para o slack caso o dado seja alerta (teste, não vai ser usado assim depois)

        // if (dadoPublic > 90) {

        //     // const axios = require('axios/dist/node/axios.cjs');
        //     // var qs = requer('qs');

        //     var mensagemAlerta = "A máquina 1 está com o uso da CPU alto!"

        //     var dados = new URLSearchParams();
        //     dados.append('payload', `{"channel": "#alertas", "username": "incoming-webhook", "text": "${mensagemAlerta}", "icon_emoji": ":ghost:"}`);

        //     var configuração = {
        //         method: 'post',
        //         url: 'https://hooks.slack.com/services/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',
        //         headers: {
        //             'Content-Type': 'application/x-www-form-urlencoded'
        //         },
        //         data: dados
        //     };

        //     axios(configuração)
        //         .then(function (response) {
        //             console.log("Notificação enviada com sucesso:", response.data);
        //         })
        //         .catch(function (error) {
        //             console.error("Erro ao enviar notificação:", error.response ? error.response.data : error.message);
        //         });
        // }
    }, 2000);
    // FIM DO GRÁFICO EM TEMPO REAL ==================================================================================



    // =============== FUNÇÕES DE GRÁFICOS ========================================================================================


    // essa função serve pra mudar as métricas na tela de acordo com o componente selecionado no header
    // quando o item for selecionado, a div correspondente aparece e as outras são escondidas.
    function alterarComponente(componenteId) {
        const dashComponentes = ["dashCpu", "dashDisco", "dashRede", "dashMemoria"];
        const componentes = {
            "dashCpu": "CPU",
            "dashDisco": "Disco",
            "dashRede": "Rede",
            "dashMemoria": "Memória"
        };

        const nomeComponentes = {
            "dashCpu": "12th Gen Intel(R) Core(TM) i5-1235U",
            "dashDisco": "Samsung MZVLQ512HBLU-00B",
            "dashRede": "Intel(R) Wireless-AC 9560 160MHz",
            "dashMemoria": "Armazenamento total: 8,00 GB"
        };

        // esconde a div de todos todos os componentes
        dashComponentes.forEach(id => {
            document.getElementById(id).style.display = "none";
        });

        dashComponentes.forEach(id => {
            document.getElementById(id).style.fontWeight = (id === componenteId) ? "700" : "500";
        });

        // mostra a div componente selecionado através do id
        console.log("id obtido: ", componenteId)
        document.getElementById(componenteId).style.display = "grid";

        // mostra o componente e a especificação dele no aside, de acordo as informações do objeto
        // document.getElementById("idComponente").innerHTML = componentes[componenteId];
        document.getElementById("idNomeComponente").innerHTML = nomeComponentes[componenteId];


        // 1- o forEach passa por todos os elementos e tira o dash do nome de cada um, e fica somente com o nome do elemento
        // exemplo: dashDisco --> Disco

        // 2- transforma em lower case, pra que fique com o id identico de cada opcao do menu
        // exemplo: Disco -->

        // 3- verifica se o id que ele está é igual ao id do componente selecionado pelo usuário. se for, a font weight fica em 700(negrito), senão, fica em 500
        dashComponentes.forEach(id => {
            const elemento = document.getElementById(id.replace("dash", "").toLowerCase());
            elemento.style.fontWeight = (id === componenteId) ? "700" : "500";
        });
    }


    //============================================ gráfico estático  para simulação ==================================================================

    function gerarValoresAleatorios(min, max) {
        return Math.floor(Math.random() * (max - min + 1) + min);
    }

    // Dados iniciais para os gráficos
    const semanas = ['últimos 20 dias', 'últimos 10 dias', 'últimos 5 dias'];

    // Função para atualizar dados dos gráficos
    function atualizarDados(chart) {
        chart.data.datasets.forEach((dataset) => {
            dataset.data = [gerarValoresAleatorios(20, 80), gerarValoresAleatorios(20, 80), gerarValoresAleatorios(20, 80)];
        });
        chart.update();
    }

    // Configuração do gráfico CPU
    const cpuChart = new Chart(document.getElementById('cpuChart'), {
        type: 'bar',
        data: {
            labels: semanas,
            datasets: [{
                label: 'Média de Uso da CPU (%)',
                data: [gerarValoresAleatorios(20, 80), gerarValoresAleatorios(20, 80), gerarValoresAleatorios(20, 80)],
                backgroundColor: 'rgba(75, 192, 192, 0.6)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100
                }
            }
        }
    });

    // Configuração do gráfico RAM
    const ramChart = new Chart(document.getElementById('ramChart'), {
        type: 'bar',
        data: {
            labels: semanas,
            datasets: [{
                label: 'Média de Uso da RAM (%)',
                data: [gerarValoresAleatorios(30, 90), gerarValoresAleatorios(30, 90), gerarValoresAleatorios(30, 90)],
                backgroundColor: 'rgba(153, 102, 255, 0.6)',
                borderColor: 'rgba(153, 102, 255, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100
                }
            }
        }
    });

    // Configuração do gráfico Rede
    const redeChart = new Chart(document.getElementById('redeChart'), {
        type: 'bar',
        data: {
            labels: semanas,
            datasets: [{
                label: 'Média de Uso da Rede (Mbps)',
                data: [gerarValoresAleatorios(100, 1000), gerarValoresAleatorios(100, 1000), gerarValoresAleatorios(100, 1000)],
                backgroundColor: 'rgba(255, 206, 86, 0.6)',
                borderColor: 'rgba(255, 206, 86, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    // Configuração do gráfico Armazenamento
    const armazenamentoChart = new Chart(document.getElementById('armazenamentoChart'), {
        type: 'bar',
        data: {
            labels: semanas,
            datasets: [{
                label: 'Média de Uso de Armazenamento (%)',
                data: [gerarValoresAleatorios(40, 95), gerarValoresAleatorios(40, 95), gerarValoresAleatorios(40, 95)],
                backgroundColor: 'rgba(255, 99, 132, 0.6)',
                borderColor: 'rgba(255, 99, 132, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100
                }
            }
        }
    });

    // Atualização automática dos gráficos a cada 10 segundos
    setInterval(() => {
        atualizarDados(cpuChart);
        atualizarDados(ramChart);
        atualizarDados(redeChart);
        atualizarDados(armazenamentoChart);
    }, 10000);
</script>