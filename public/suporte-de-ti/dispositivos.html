<!DOCTYPE html>
<html lang="ptbr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href=".././css/dashboardDispositivos.css">
    <link rel="shortcut icon" href=".././src/img/logoB.png" type="image/x-icon" />

    <title>Dispositivos | Staff Watch</title>
</head>

<body onload="atualizarFeed()">
    <header>
        <div class="opcoes">
            <div class="esq">
                <div class="logo">
                    <img href="index.html" src=".././src/img/logoB.png" alt="logo">
                </div>

                <div class="menuCima" id="itens">
                    <h6 class="opcoesMenu slct" onclick="window.location.href='dispositivos.html'">Dispositivos</h6>
                </div>
            </div>

            <div class="sair">
                <h6 class="opcoesMenu sair" onclick="sair()"> Sair </h6>
            </div>
        </div>
    </header>
    <div class="corpo">
        <div class="menuLateral">
            <div class="itens">
                <h4 id="1" onclick="window.location.href='../dashboard-matheus.html'"> CPU </h4>
                <h4 id="2" onclick="window.location.href='../dashboard-matheus.html'">Disco</h4>
                <h4 id="3" onclick="window.location.href='../dashboard-matheus.html'">Rede</h4>
                <h4 id="4" onclick="window.location.href='../dashboard-matheus.html'">RAM</h4>
            </div>
        </div>

        <!-- reutilizando da página de máquinas -->

        <main class="main-section">
            <section class="section-grafico">
                <h4> Quantidade de alertas por componente em cada equipe </h4>
                <div class="grafico">
                    <!-- <img src=".././src/img/grafico.png" alt=""> -->
                    <canvas id="graficoEquipe"></canvas>
                </div>
            </section>

            <section class="sectioncard" id="sectioncard">



                <!-- <div class="card open-modal" onclick="alterarComponente('dashCpu')">

                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorAlerta.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                            <div class="alertaMaquina">
                                <figure> <img src=".././src/img/icons/alerta1.png"> </figure>
                                <p> CPU acima da média (2 horas)</p>
                            </div>
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> 1234</p>
                            <p><b>Funcionário:</b> Julia Oliveira</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" alt="">
                            <img src=".././src/img/icons/excluir.svg" alt="">
                        </div>
                    </div>
                </div>

                <div class="card open-modal" onclick="alterarComponente('dashCpu')">

                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorCritico.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                            <div class="alertaMaquina">
                                <figure> <img src=".././src/img/icons/alerta2.png"> </figure>
                                <p> CPU acima da média (8 horas)</p>
                            </div>
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> 1234</p>
                            <p><b>Funcionário:</b> Edu Macedo</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" alt="">
                            <img src=".././src/img/icons/excluir.svg" alt="">
                        </div>
                    </div>
                </div>

                <div class="card open-modal" onclick="alterarComponente('dashCpu')">

                    <div class="down-card cima">
                        <div class="esqCard">
                            <figure class="iconComp">
                                <img src=".././src/img/icons/indicadoresMaquina/computadorEstavel.png" alt="">
                            </figure>
                        </div>

                        <div class="dirCard">
                            
                        </div> 
                        </div>

                    </div>
                    <div class="down-card">
                        <div class="content-card">
                            <p><b>ID:</b> 1234</p>
                            <p><b>Funcionário:</b> Pedro Lima</p>
                        </div>
                        <div class="up-card">
                            <img src=".././src/img/icons/editar.svg" alt="">
                            <img src=".././src/img/icons/excluir.svg" alt="">
                        </div>
                    </div>
                </div>
                 -->
            </section>
        </main>

        <!--  MODAL  -->
        <div id="fade" class="hide"></div>
        <div id="modal" class="hide">
            <div class="btnSair">
                <img src=".././src/img/icons/fechar.svg" alt="ícone para sair do modal">
            </div>
            <div class="modal-content">
                <div class="containerModal">
                    <div class="opcoesComponentes menu" id="itens">
                        <h6 class="opcoesMenu" id="cpu" onclick="alterarComponente('dashCpu')"> CPU </h6>
                        <h6 class="opcoesMenu" id="disco" onclick="alterarComponente('dashDisco')"> Disco </h6>
                        <h6 class="opcoesMenu" id="rede" onclick="alterarComponente('dashRede')"> Rede </h6>
                        <h6 class="opcoesMenu" id="memoria" onclick="alterarComponente('dashMemoria')"> Memória
                        </h6>
                    </div>

                    <div class="aside">
                        <div class="dadosComponente">
                            <div class="infosComponente">
                                <!-- <h6 class="componente" id="idComponente"> CPU </h6> -->
                                <h6 class="nomeComponente" id="idNomeComponente"> nome do componente </h6>
                            </div>

                            <h5 class="monitoramento" id="idMonitoramentoGrafico"> Utilização: </h5>
                        </div>

                        <div class="graficoComponente">
                            <div class="graficoChart">
                                <canvas id="myChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div id="dashCpu" class="bside">
                        <div class="dado">
                            <h3> Utilização: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuUtilizacao"> -- </span> </h2>
                            </div>
                        </div>
                        <div class="dado">
                            <h3> Média de uso: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuMedia"> -- </span> </h2>
                            </div>
                        </div>
                        <!-- <div class="dado">
                            <h3> Threads: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuThreads"> 2400 </span> </h2>
                            </div>
                        </div>
                        <div class="dado">
                            <h3> Processos: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuProcessos"> 140 </span> </h2>
                            </div>
                        </div>
                        <div class="dado">
                            <h3> Identificadores: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuIdentificadores"> 82750 </span> </h2>
                            </div>
                        </div>
                        <div class="dado">
                            <h3> Tempo de atividade:</h3>
                            <div class="dadoInfo">
                                <h2> <span id="cpuTempoDeAtividade"> 0:08:17:42 </span> </h2>
                            </div>
                        </div> -->
                    </div>

                    <div id="dashDisco" class="bside">
                        <div class="dado">
                            <h3> Utilização: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="discoUtilizacao"> -- </span> </h2>
                            </div>
                        </div>


                        <div class="dado">
                            <h3> Média de uso: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="discoMediaUso"> -- </span> </h2>
                            </div>
                        </div>

                        <!-- <div class="dado">
                            <h3> Tempo médio de resposta: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="discoMediaResposta"> -- </span> </h2>
                            </div>
                        </div> -->
                        <!-- 
                        <div class="dado">
                            <h3> Velocidade de gravação: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="discoGravacao"> 130,2 KB/s </span> </h2>
                            </div>
                        </div> -->
                    </div>

                    <div id="dashRede" class="bside">
                        <div class="dado">
                            <h3> Pacotes Enviados: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="redeEnviar"> -- </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Pacotes Recebidos: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="redeReceber"> -- </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Pacotes Perdidos: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="redePerdido"> -- </span> </h2>
                            </div>
                        </div>

                    </div>


                    <div id="dashMemoria" class="bside">

                        <div class="dado">
                            <h3> Utilização: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaUtilizacao"> -- </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Média de uso: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaMedia"> -- </span> </h2>
                            </div>
                        </div>

                        <!-- <div class="dado">
                            <h3> Confirmado: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaConfirmado"> 10,1/22,7 GB </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Cache: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaCache"> 4,6 GB </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Reserva paginável: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaPaginavel"> 580 MB </span> </h2>
                            </div>
                        </div>

                        <div class="dado">
                            <h3> Reserva não paginável: </h3>
                            <div class="dadoInfo">
                                <h2> <span id="memoriaNaoPaginavel"> 460 MB </span> </h2>
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<!-- script do modal -->
<script src=".././js/modalDispositivo.js"></script>
<!-- script do chartJs -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

</html>

<script>
    let editarAlgo = false
    // ==========  FUNÇÕES DO MODAL  ================================================================================================================================================
    // função pra fechar o modal quando clicar4 no botão de X e na parte de fora do modal
    document.getElementById('fade').addEventListener('click', function () {
        document.getElementById('fade').classList.add('hide');
        document.getElementById('modal').classList.add('hide');
    });


    document.querySelector('.btnSair').addEventListener('click', function () {
        document.getElementById('fade').classList.add('hide');
        document.getElementById('modal').classList.add('hide');
    });


    // COLANDO TODAS AS FUNCIOES DO SCRIPT.JS AQUI PRO MODAL FUNCIONAR!!!
    // Seleção de elementos do modal
    const openModal = document.querySelectorAll(".open-modal");
    const closeModal = document.querySelector("#close-modal");
    const modal = document.querySelector("#modal");
    const fade = document.querySelector("#fade");

    // Função para alternar a visibilidade do modal
    const toggleModal = () => {
        modal.classList.toggle("hide");
        fade.classList.toggle("hide");
    };


    // =================================================================================================================

    // =============== FUNÇÕES DE GRÁFICOS ========================================================================================
    let idComponente = 0

    // essa função serve pra mudar as métricas na tela de acordo com o componente selecionado no header
    // quando o item for selecionado, a div correspondente aparece e as outras são escondidas.
    function alterarComponente(componenteId) {
        const dashComponentes = ["dashCpu", "dashDisco", "dashRede", "dashMemoria"];
        const componentes = {
            "dashCpu": "CPU",
            "dashDisco": "Disco",
            "dashRede": "Rede",
            "dashMemoria": "Memória"
        };

        const nomeComponentes = {
            "dashCpu": "Modelo da CPU não obtido.",
            "dashDisco": "Modelo do Disco não obtido.",
            "dashRede": "Modelo da placa de rede não obtido.",
            "dashMemoria": "Armazenamento total não obtido."
        };

        console.log("ID do componente selecionado: ", componenteId);

        // Esconde a div de todos os componentes
        dashComponentes.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.style.display = "none"; // Garante que o elemento existe antes de manipular
            } else {
                console.log(`Elemento não encontrado para ID: ${id}`);
            }
        });

        // Define o peso da fonte de todos os elementos
        dashComponentes.forEach(id => {
            const element = document.getElementById(id.replace("dash", "").toLowerCase());
            if (element) {
                element.style.fontWeight = (id === componenteId) ? "700" : "500";
            } else {
                console.log(`Elemento não encontrado para o ID no menu: ${id.replace("dash", "").toLowerCase()}`);
            }
        });

        // Mostra a div do componente selecionado
        const selectedComponent = document.getElementById(componenteId);
        if (editarAlgo) {
            return;
        }
        console.log("Componente a ser exibido: ", selectedComponent);
        if (selectedComponent) {
            selectedComponent.style.display = "grid"; // Garante que o componente é mostrado
        } else {
            console.log(`Elemento não encontrado para o ID: ${componenteId}`);
        }

        // Atualiza o nome do componente no aside
        const componentName = nomeComponentes[componenteId];
        const nomeComponenteElem = document.getElementById("idNomeComponente");
        if (nomeComponenteElem) {
            nomeComponenteElem.innerHTML = componentName;
        } else {
            console.log("Elemento 'idNomeComponente' não encontrado.");
        }

        if (componenteId == "dashCpu") {
            idComponente = 4
        } else if (componenteId == "dashDisco") {
            idComponente = 3
        }
        else if (componenteId == "dashRede") {
            idComponente = 1
        }
        else if (componenteId == "dashMemoria") {
            idComponente = 2
        }

        obterDadosGrafico(idComponente)
        console.log(`idComponente em alterarComponente: ${idComponente}`)

    }



    // ============= FUNÇÃO DE ATUALIZAR O FEED - LISTAR MÁQUINAS

    function atualizarFeed() {
        var fkEmpresa = sessionStorage.getItem("ID_EMPRESA");
        // console.log(fkEmpresa);
        fetch(`/maquinas/listar/${fkEmpresa}`)
            .then(function (resposta) {
                if (resposta.ok) {
                    if (resposta.status == 204) {
                        var feed = document.getElementById("sectioncard");
                        var mensagem = document.createElement("span");
                        mensagem.innerHTML = "Nenhum resultado encontrado.";
                        feed.appendChild(mensagem);
                        throw "Nenhum resultado encontrado!";
                    }

                    return resposta.json();
                } else {
                    throw 'Houve um erro na API!';
                }
            })
            .then(function (resposta) {
                // console.log("Dados recebidos: ", JSON.stringify(resposta));

                var feed = document.getElementById("sectioncard");
                feed.innerHTML = ""; // Limpa o conteúdo atual do feed
                resposta.forEach(publicacao => {
                    var card = document.createElement("div");
                    card.classList.add("card", "open-modal"); // Adiciona a classe para abrir o modal

                    // Adicionando o evento para abrir o modal
                    card.addEventListener("click", function () {
                        alterarComponente('dashCpu');  // Altera o componente
                        toggleModal();  // Abre o modal após alterar o componente
                    });

                    // Atualiza o status baseado no valor numérico
                    let status = publicacao.status === 1 ? "Em atividade" : "Inativo";

                    // Adicionando o conteúdo HTML do card
                    card.innerHTML = `
                <div class="down-card cima">
                    <div class="esqCard">
                        <figure class="iconComp">
                            <img src=".././src/img/icons/indicadoresMaquina/computadorEstavel.png" alt="">
                        </figure>
                    </div>
                    <div class="dirCard" id="maquina${publicacao.idComputador}"></div>
                </div>
                <div class="down-card">
                    <div class="content-card">
                        <p><b>ID:</b> ${publicacao.idComputador}</p>
                        <p><b>Equipe:</b> ${publicacao.fkEquipe}</p>
                        <p><b>Funcionário:</b> ${publicacao.nomeFuncionario}</p>
                        <p><b>Status:</b> ${status}</p>
                    </div>
                    <div id="editar" class="up-card">
                        <img src=".././src/img/icons/editar.svg" onclick="atualizarMaquina(${publicacao.idComputador})">
                        <img src=".././src/img/icons/excluir.svg" onclick="deletar(${publicacao.idComputador})">
                    </div>
                </div>
            `;
                    feed.appendChild(card);
                });
            })
            .catch(function (erro) {
                console.error("Erro ao atualizar o feed:", erro);
            });
    }



    // ============================================================================================================



    // ============ SIMULAÇÃO DO GRÁFICO DA PARTE SUPERIOR DA TELA ==============================================

    // Gerar valores aleatórios entre 2 e 19

    function getRandomValues() {
        return [Math.floor(Math.random() * 18) + 2, Math.floor(Math.random() * 18) + 2, Math.floor(Math.random() * 18) + 2, Math.floor(Math.random() * 18) + 2];
    }

    const data = {
        labels: ['Equipe 1', 'Equipe 2', 'Equipe 3', 'Equipe 4'],
        datasets: [
            {
                label: 'CPU',
                data: getRandomValues(),
                backgroundColor: 'rgba(255, 99, 132, 0.6)',
                borderColor: 'rgba(255, 99, 132, 1)',
                borderWidth: 1
            },
            {
                label: 'Rede',
                data: getRandomValues(),
                backgroundColor: 'rgba(54, 162, 235, 0.6)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            },
            {
                label: 'RAM',
                data: getRandomValues(),
                backgroundColor: 'rgba(75, 192, 192, 0.6)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            },
            {
                label: 'Disco',
                data: getRandomValues(),
                backgroundColor: 'rgba(153, 102, 255, 0.6)',
                borderColor: 'rgba(153, 102, 255, 1)',
                borderWidth: 1
            }
        ]
    };

    const config = {
        type: 'bar',
        data: data,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top', // Posição da legenda à esquerda
                    align: 'center',  // Centraliza a legenda verticalmente
                }
            },
            scales: {
                x: {
                    stacked: false
                },
                y: {
                    beginAtZero: true,
                    max: 20
                }
            },
        }
    };

    new Chart(
        document.getElementById('graficoEquipe'),
        config
    );

    // funcoes do card da equipe: editar e remover máquina

    function atualizarMaquina(idComputador) {
        editarAlgo = true
        // Redireciona o usuário para a página de edição com o ID do funcionário como parâmetro na URL
        if (confirm("Tem a certeza de que deseja reativar esta máquina?")) {
            // window.location.href = "dispositivos.html"

            fetch(`/maquinas/atualizarMaquina/${idComputador}`, {
                method: "PUT"
            })
                .then(resposta => {
                    if (resposta.ok) {
                        alert("Máquina reativada com sucesso!");
                        atualizarFeed(); // Atualiza a lista após a exclusão
                    } else {
                        throw "Não foi possível reaativar a maquina";
                    }
                })
                .catch(error => {
                    console.error(error);
                    alert("Ocorreu um erro ao tentar reativar a maquina");
                });
        }
    }

    function deletar(idComputador) {
        editarAlgo = true
        if (confirm("Tem a certeza de que deseja desativar esta máquina?")) {
            fetch(`/maquinas/deletar/${idComputador}`, {
                method: "PUT"
            })
                .then(resposta => {
                    if (resposta.ok) {
                        alert("Máquina desativada com sucesso!");
                        atualizarFeed(); // Atualiza a lista após a exclusão
                    } else {
                        throw "Não foi possível desativar a maquina";
                    }
                })
                .catch(error => {
                    console.error(error);
                    alert("Ocorreu um erro ao tentar deletar a maquina");
                });
        }
    }

    function sair() {
        sessionStorage.clear()
        window.location = "../index.html"
    }

    function selecionarItem(elemento) {
        // Salvar o id do item selecionado no localStorage
        localStorage.setItem('equipeSelecionada', elemento.id);

        // Remover a classe 'slc' de todos os h4
        var itens = document.querySelectorAll('.menuLateral .itens h4');
        itens.forEach(function (item) {
            item.classList.remove('slc');
        });

        // Adicionar a classe 'slc' ao item clicado
        elemento.classList.add('slc');

    }
    // lembrar de chamar essa funcao pra exibir os graficos dinamicos
    //         alterarComponente("dashCpu");
    //          Chama a função que recarrega a dashboard para a equipe selecionada
    // carregarDashboard(elemento.id);

    //============== GRÁFICO DE MONITORAMENTO EM TEMPO REAL  ==================================================================================

    // Função para buscar os dados iniciais
    // let indiceAtual = 0; // Variável global para rastrear o índice atual
    let dadosRecebidos = []; // Variável para armazenar os dados recebidos
    // let myChart = null;
    console.log(`mychart: ${myChart}`)

    function obterDadosGrafico(idComponente) {
        fetch(`/dispositivos/metrica/${idComponente}`, {
            cache: 'no-store',
            method: "GET",
        })
            .then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                        dadosRecebidos = resposta; // Salva os dados recebidos
                        gerarGraficoTempoReal(idComponente); // Inicia o gráfico
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function gerarGraficoTempoReal(idComponente) {
        const ctx = document.getElementById('myChart').getContext('2d');

        if (window.myChart instanceof Chart) {
            window.myChart.destroy();
        }
        // Ajustar os dados recebidos para o gráfico
        // const labels = dadosRecebidos.map(item => item.timestamp); // Supondo que cada item tenha um timestamp
        // const data = dadosRecebidos.map(item => item.uso); // Supondo que "uso" seja o valor que você quer plotar


        // Inicialização do gráfico vazio
        window.myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [], // Inicialmente vazio
                datasets: [{
                    label: '% de uso',
                    data: [], // Inicialmente vazio
                    borderWidth: 1,
                    borderColor: "#C7D",
                    backgroundColor: "#C7D"
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
        // Garante que o gráfico foi criado antes de chamar a atualização
        console.log("myChart inicializado:", myChart);
        atualizarGrafico(idComponente)
    }

    // Função para adicionar valores incrementalmente
    function atualizarGrafico(idComponente) {
        let indiceAtual = 0;

        const intervalo = setInterval(() => {
            if (!myChart) {
                console.warn("myChart ainda não foi inicializado. Tentando novamente...");
                return; // Aguarde até que myChart seja inicializado
            }

            if (indiceAtual < dadosRecebidos.length) {
                const dadoAtual = dadosRecebidos[indiceAtual];
                let momento = dadoAtual.dataCaptura;
                let temperatura = dadoAtual.captura;

                // Adiciona os novos dados ao gráfico
                myChart.data.labels.push(momento);
                myChart.data.datasets[0].data.push(temperatura);

                // Remove o ponto mais antigo se o gráfico exceder 20 pontos
                if (myChart.data.labels.length > 20) {
                    myChart.data.labels.shift();
                    myChart.data.datasets[0].data.shift();
                }

                // Atualiza o gráfico
                myChart.update();

                // Incrementa o índice para o próximo dado
                indiceAtual++;

                // Atualiza os KPIs conforme o idComponente
                if (idComponente == 1) { // rede
                    redeEnviar.innerHTML = `${dadoAtual.enviado}%`
                    redeReceber.innerHTML = `${dadoAtual.recebido}%`
                    redePerdido.innerHTML = `${dadoAtual.perdido}%`
                    idNomeComponente.innerHTML = dadoAtual.modelo
                } else if (idComponente == 2) { // memória
                    memoriaUtilizacao.innerHTML = `${dadoAtual.captura}%`
                    idNomeComponente.innerHTML = dadoAtual.modelo

                    // Média de memória
                    atualizarMediaGrafico(idComponente);
                } else if (idComponente == 3) { // disco
                    discoUtilizacao.innerHTML = `${dadoAtual.captura}%`
                    idNomeComponente.innerHTML = dadoAtual.modelo

                    // Média de disco
                    atualizarMediaGrafico(idComponente);
                } else if (idComponente == 4) { // CPU
                    cpuUtilizacao.innerHTML = `${dadoAtual.captura}%`
                    idNomeComponente.innerHTML = dadoAtual.modelo

                    // Média de CPU
                    atualizarMediaGrafico(idComponente);
                }

            } else {
                console.log('Todos os dados foram exibidos.');
                clearInterval(intervalo); // Para o intervalo quando todos os dados forem exibidos
            }
        }, 2000); // Intervalo de 2 segundos
    }
    // Atualiza o gráfico a cada 2 segundos
    // const intervalo = setInterval(atualizarGrafico, 2000);


    function atualizarMediaGrafico(idComponente) {
        const capturasExibidas = myChart.data.datasets[0].data;
        const soma = capturasExibidas.reduce((acumulador, valor) => acumulador + valor, 0);
        const media = soma / capturasExibidas.length;

        // Atualiza a média conforme o idComponente
        if (idComponente == 2) { // Memória
            memoriaMedia.innerHTML = `${Math.round(media)}%`;
        } else if (idComponente == 3) { // Disco
            discoMediaUso.innerHTML = `${Math.round(media)}%`;
        } else if (idComponente == 4) { // CPU
            cpuMedia.innerHTML = `${Math.round(media)}%`;
        }
    }




    // enviando alerta para o slack caso o dado seja alerta (teste, não vai ser usado assim depois)

    // if (dadoPublic > 90) {

    //     // const axios = require('axios/dist/node/axios.cjs');
    //     // var qs = requer('qs');

    //     var mensagemAlerta = "A máquina 1 está com o uso da CPU alto!"

    //     var dados = new URLSearchParams();
    //     dados.append('payload', `{"channel": "#alertas", "username": "incoming-webhook", "text": "${mensagemAlerta}", "icon_emoji": ":ghost:"}`);

    //     var configuração = {
    //         method: 'post',
    //         url: 'https://hooks.slack.com/services/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',
    //         headers: {
    //             'Content-Type': 'application/x-www-form-urlencoded'
    //         },
    //         data: dados
    //     };

    //     axios(configuração)
    //         .then(function (response) {
    //             console.log("Notificação enviada com sucesso:", response.data);
    //         })
    //         .catch(function (error) {
    //             console.error("Erro ao enviar notificação:", error.response ? error.response.data : error.message);
    //         });
    // }
    // }

    // FIM DO GRÁFICO EM TEMPO REAL ==================================================================================

</script>